#!/usr/bin/env node
"use strict";

var is = require("is");
var log = require("engram/logger");

var Result = require("engram/result").Result;
var Ok = require("engram/result").Ok;
var Err = require("engram/result").Err;

var eventBus = require("engram/pubsub");
var constants = require("engram/constants");

constants.BUS.on(":title", function (saveResult) {

	saveResult.onErr(function (err) {
		log.error({ message: err.message, stack: err.stack }, "title extraction failed.");
	});

	saveResult.onOk(function (url) {

		if (!is.undefined(url)) {
			log.info("successfully extracted title for " + url);
		}
	});
});

constants.BUS.on(":softfail", function (saveResult) {

	saveResult.onErr(function (err) {
		log.error({ message: err.message, stack: err.stack }, "soft-fail determination failed.");
	});

	saveResult.onOk(function (url) {

		if (!is.undefined(url)) {
			log.info("successfully determinated soft-fail status for " + url);
		}
	});
});

constants.BUS.on(":status", function (saveResult) {

	saveResult.onErr(function (err) {
		log.error({ message: err.message, stack: err.stack }, "status determination failed.");
	});

	saveResult.onOk(function (url) {

		if (!is.undefined(url)) {
			log.info("successfully determinated fail status for " + url);
		}
	});
});

module.exports = BUS;