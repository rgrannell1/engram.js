#!/usr/bin/env node

"use strict"





var log = require('engram/logger')
var is  = require('is')

var Result = require('engram/result').Result
var Ok     = require('engram/result').Ok
var Err    = require('engram/result').Err

var URL    = require('url')





var getID = bookmark => {

	is.always.object(bookmark)

	if (bookmark.hasOwnProperty('bookmark_id')) {
		return bookmark.bookmark_id
	} else {
		var erroneous = JSON.stringify(bookmark)
		throw Error(`no key "bookmark_id" in bookmark object; ${erroneous}`)
	}

}




var bookmark = row => {

	var parsed      = URL.parse(row.url)

	return Ok({
		bookmark_id:    row.bookmark_id,
		url:            row.url,

		title:          row.title,
		ctime:          row.ctime,

		status_code:    row.status_code,
		is_soft_failer: row.is_soft_failer,

		hostname:       parsed.hostname,
		hosturl:        URL.format(parsed)
	})

}



module.exports = {
	getID,
	bookmark
}
