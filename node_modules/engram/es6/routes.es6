#!/usr/bin/env node

"use strict"





var Result        = require('engram/result').Result
var Ok            = require('engram/result').Ok
var Err           = require('engram/result').Err





var express      = require('express')
var saveBookmark = require('engram/save-bookmark')
var log          = require('engram/logger')




var api = express.Router( )
var app = express.Router( )





var parseURL = url => {
	return url // -- TODO STUB
}




app.get('/*', (req, res) => {

	var pathResult = Ok(req)
		.then(req => req.url)
		.then(url => url.slice(1))
		.then(parseURL)

	pathResult.onOk(path => {

		log.info(`GET ${path}`)

		saveBookmark(path, new Date( ).getTime( ), {req, res})

		res.status(204)
		res.end( )

	})

	pathResult.onErr(path => {

		res.status(204)
		res.end( )

	})

})



module.exports = {
	api,
	app
}
