#!/usr/bin/env node

"use strict"





var is       = require('is')
var log      = require('engram/logger')

var Result   = require('engram/result').Result
var Ok       = require('engram/result').Ok
var Err      = require('engram/result').Err

var eventBus = require('engram/pubsub')





var STATSBUS = eventBus( )





STATSBUS.on(':title', saveResult => {

	saveResult.onErr(err => {
		log.error({message: err.message, stack: err.stack}, 'title extraction failed.')
	})

	saveResult.onOk(url => {

		if (!is.undefined(url)) {
			log.info(`successfully extracted title for ${url}`)
		}

	})

})

STATSBUS.on(':softfail', saveResult => {

	saveResult.onErr(err => {
		log.error({message: err.message, stack: err.stack}, 'soft-fail determination failed.')
	})

	saveResult.onOk(url => {

		if (!is.undefined(url)) {
			log.info(`successfully determinated soft-fail status for ${url}`)
		}

	})

})

STATSBUS.on(':status', saveResult => {

	saveResult.onErr(err => {
		log.error({message: err.message, stack: err.stack}, 'status determination failed.')
	})

	saveResult.onOk(url => {

		if (!is.undefined(url)) {
			log.info(`successfully determinated fail status for ${url}`)
		}

	})

})








module.exports = STATSBUS
