
"use strict"



var http                 = require('http')
var https                = require('https')

var express              = require('express')
var commons              = require('engram/es6-new/commons/commons')
var createTables         = require('engram/es6-new/persistance/create-tables')
var createTLSCredentials = require('engram/es6-new/security/create-tls-credentials')
var loadTLSCredentials   = require('engram/es6-new/security/load-tls-credentials')





var startApp = (args, database, callback) => {

	var credentials = loadTLSCredentials(args.keypath, args.certpath)

	var apps = {
		http:  http.createServer(express( )),
		https: https.createServer(credentials, express( ))
	}

	createTables(database, createResult => {

		createResult.onErr(( ) => {
			console.log('error.')
		})

		createResult.onOk(( ) => {
			console.log('loaded ok.')
		})

	})

}




module.exports = startApp

