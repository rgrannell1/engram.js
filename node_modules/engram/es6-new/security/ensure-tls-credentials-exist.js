
"use strict"





var fs                   = require('fs')

var Result               = require('engram/es6-new/commons/result').Result
var Ok                   = require('engram/es6-new/commons/result').Ok
var Err                  = require('engram/es6-new/commons/result').Err

var createTLSCredentials = require('engram/es6-new/security/create-tls-credentials')





var ensureTLSCredentialsExist = (args, callback) => {

	var ensureResult = Result.of(( ) => {

		var keypathExists  = fs.lstatSync(args.keypath) .isFile( )
		var certpathExists = fs.lstatSync(args.certpath).isFile( )

		return keypathExists && certpathExists

	})

	ensureResult.onOk(bothExist => {

		if (args.certs || !bothExist) {
			createTLSCredentials(args.keypath, args.certpath, createResult => {
				callback(createResult)
			})
		}

	})

	callback(ensureResult)

}





module.exports = ensureTLSCredentialsExist
