
"use strict"



var http                 = require('http')
var https                = require('https')
var express              = require('express')

var commons              = require('engram/commons/commons')
var createTables         = require('engram/persistance/create-tables')
var createTLSCredentials = require('engram/security/create-tls-credentials')
var loadTLSCredentials   = require('engram/security/load-tls-credentials')
var log                  = require('engram/logging/logger')
var attachRoutes         = require('engram/app/attach-routes')
var routes               = require('engram/rest/routes')






var createApp = (args, database, callback) => {

	var credentials = loadTLSCredentials(args.keypath, args.certpath)

	var apps = {
		http:  attachRoutes(express( ), routes.http),
		https: attachRoutes(express( ), routes.https)
	}

	var servers = {
		http:  http.createServer(apps.http),
		https: https.createServer(credentials, apps.https)
	}

	callback(servers)

}




module.exports = createApp
