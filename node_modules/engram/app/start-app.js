
"use strict"




var log     = require('engram/logging/logger')
var commons = require('engram/commons/commons')




var startApp = (args, apps, servers, callback) => {

	var protocols = Object.keys(servers)

	commons.async.collectMap(
		protocols,
		(protocol, done, ith) => {

			servers[protocol].listen(args.port + ith, 'localhost', ( ) => {

				log.global.info({port: args.port + ith}, `Engram (${protocol}) listening.`)
				done( )

			})

		},
		( ) => {
			callback(apps, servers)
		}
	)

}





module.exports = startApp
