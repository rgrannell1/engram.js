
"use strict"





var fs                   = require('fs')

var log                       = require('engram/logging/logger')
var Result               = require('engram/commons/result').Result
var Ok                   = require('engram/commons/result').Ok
var Err                  = require('engram/commons/result').Err

var createTLSCredentials = require('engram/security/create-tls-credentials')
var checkTLSCredentials  = require('engram/security/check-tls-credentials')




var ensureTLSCredentialsExist = (args, callback) => {

	checkTLSCredentials(args, bothExist => {

		if (!bothExist) {

			log.security.info({ }, 'creating missing tls credentials.')

			createTLSCredentials(args.keypath, args.certpath, createResult => {
				callback(createResult)
			})
		}

	})

}





module.exports = ensureTLSCredentialsExist
