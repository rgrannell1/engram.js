
"use strict"





var fs                   = require('fs')

var log                  = require('engram/logging/logger')

var createTLSCredentials = require('engram/security/create-tls-credentials')
var checkTLSCredentials  = require('engram/security/check-tls-credentials')




var ensureTLSCredentialsExist = (args, callback) => {

	checkTLSCredentials(args, bothExist => {

		if (!bothExist) {

			log.security.info({ }, 'creating missing tls credentials.')

			createTLSCredentials(args.keypath, args.certpath, err => {
				callback(err)
			})

		} else {

			log.security.info({ }, 'tls credentials already exist.')

			callback(null)

		}

	})

}





module.exports = ensureTLSCredentialsExist
