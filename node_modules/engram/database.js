#!/usr/bin/env node
"use strict";

var log = require("engram/logger");

try {

	var Result = require("engram/result").Result;
	var Ok = require("engram/result").Ok;
	var Err = require("engram/result").Err;

	var log = require("engram/logger");
	var sqlite3 = require("sqlite3").verbose();

	var path = require("path");
} catch (err) {

	log.fatal({
		message: err.message,
		stacK: err.stack }, "failed to load dependencies.");

	process.exit();
}

var database = new sqlite3.Database(path.join(process.cwd(), "data", "engram.db"));

module.exports = {
	"do": function (executor, callback) {

		database.serialize(function () {

			executor(database, callback);
		});
	},
	close: database.close
};
