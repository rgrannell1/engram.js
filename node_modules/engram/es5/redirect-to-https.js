#!/usr/bin/env node


"use strict";

var log = require('engram/es5/logging/logger');

var redirectToHttps = function redirectToHttps(port) {
	return function (req, res, next) {

		var originalUrl = "http://" + req.headers.host + req.originalUrl;

		var httpsURL = ("https://" + req.headers.host + req.originalUrl).replace(":" + port, ":" + (port + 1));

		log.global.info("GET " + req.originalUrl);
		log.global.info("redirecting " + originalUrl + " -> " + httpsURL);

		res.writeHead(301, {
			Location: httpsURL
		});

		res.end();
		next();
	};
};

module.exports = redirectToHttps;
