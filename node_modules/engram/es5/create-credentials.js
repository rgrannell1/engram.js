#!/usr/bin/env node


"use strict";

var is = require('is');
var pem = require('pem');
var log = require('engram/es5/logger');
var fs = require('fs');

var createCredentials = function createCredentials(keypath, certpath) {

	log.global.info('creating credentials.');

	pem.createCertificate({

		days: constants.CERT_EXPIRATION,
		selfSigned: true,

		keyBitsize: constants.CERT_KEYSIZE,
		commonName: constants.CERT_COMMONNAME,
		country: constants.CERT_COUNTRY

	}, function (err, keys) {

		if (err) {

			log.global.fatal({ err: err }, 'failed to generate certificates.');
			process.exit(1);
		}

		fs.writeFileSync(keypath, keys.serviceKey);
		fs.writeFileSync(certpath, keys.certificate);
	});
};

createCredentials.precond = function (keypath, certpath) {

	is.always.string(keypath);
	is.always.string(certpath);
};

module.exports = createCredentials;
