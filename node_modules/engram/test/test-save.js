#!/usr/bin/env node
"use strict";

var http = require("http");
var should = require("should");
var request = require("supertest");
var engram = require("engram/engram");

var app = engram({
	port: 5000,
	dbpath: ":memory:"
});

describe("/*", function () {

	it("should 404 for non-http/https URLs", function () {

		;["/ftp://foo.bar", "/file://baz.bar"].forEach(function (url) {

			request(app).get(url).expect(404).end(function (err) {
				if (err) throw err;
			});
		});
	});

	it("should 204 for http and https", function () {

		;["/http://google.com", "/https://google.com", "/http://google.com?foo=bar&bash=baz", "/https://bar/baz/?foo=bar&bash=baz", "/www.google.com?foo=bar&bash=baz"].forEach(function (url) {

			request(app).get(url).expect(204).end(function (err) {
				if (err) throw err;
			});
		});
	});
});