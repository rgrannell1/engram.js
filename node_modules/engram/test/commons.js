
"use strict"




var is        = require('is')
var constants = require('./constants')





var commons = { }

commons.defaultArgs = obj => {

	return {
		'--port':     obj.port     || '5000',
		'--dbpath':   obj.dbpath   || 'data/engram.db',
		'--keypath':  obj.keypath  || 'certs/key.pem',
		'--certpath': obj.certpath || 'certs/cert.pem',
		'--logs':     obj.logs     || false,
		'--database': obj.database || false,
		run:          obj.run      || true,
		certs:        obj.certs    || false,
		wipe:         obj.wipe     || false,
	}

}

var port = 2000

commons.freePortNumber = ( ) => {
	port += 10
	return port + ''
}

commons.listRoutes = app => {

	var recur = data => {

		if (data._router && data._router.stack) {

			var inner = data._router.stack.map(recur)
			return [ ].concat.apply([ ], inner)

		}

		if (data.handle && data.handle.stack) {

			var inner = data.handle.stack.map(recur)
			return [ ].concat.apply([ ], inner)

		}

		if (data.route) {
			return [data.route.path]
		}

	}

	return recur(app).filter(is.string)

}





module.exports = commons
