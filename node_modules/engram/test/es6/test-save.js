#!/usr/bin/env node





var should    = require('should')
var request   = require('supertest')
var engram    = require('engram/engram')




var app

describe('/*', ( ) => {

	before(done => {

		app = engram(5000)
		setTimeout(done, 2000)

	})


	it('should 404 for non-http/https URLs', ( ) => {

		request(app)
		.get('/ftp://foo.bar')
		.expect(404)
		.end((err, res) => {

			if (err) {
				throw err
			}

		})

		request(app)
		.get('/file://baz.bar')
		.expect(404)
		.end((err, res) => {

			if (err) {
				throw err
			}

		})

	})


	it('should 200 for http', ( ) => {

		request(app)
		.get('/http://google.com')
		.expect(200)
		.end((err, res) => {

			if (err) {
				throw err
			}

		})

	})

	it('should 200 for https', ( ) => {

		request(app)
		.get('/https://google.com')
		.expect(200)
		.end((err, res) => {

			if (err) {
				throw err
			}

		})

	})

	it('should 200 for http with query string', ( ) => {

		request(app)
		.get('/http://google.com?foo=bar&bash=baz')
		.expect(200)
		.end((err, res) => {

			if (err) {
				throw err
			}

		})

	})

})
