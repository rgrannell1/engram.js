"use strict"





var is      = require('is')
var commons = require('engram/commons/commons')




var applyPatch = (patch, spec) => {

	if (spec.id !== patch.id) {
		return spec
	}


	return commons.data.objMap(spec, (key, value) => {

		if (!patch.hasOwnProperty(key)) {

			return value

		} else {

			return is.function(patch[key])
				? patch[key](value)
				: patch[key]

		}

	})

}





var implement = (specs, patch) => {

	implement.precond(specs, patch)

	specs.routes = specs.routes.map(applyPatch.bind({ }, patch))

	return specs

}

implement.precond = (specs, patch) => {

	is.always.string(patch.id)

}





module.exports = implement
